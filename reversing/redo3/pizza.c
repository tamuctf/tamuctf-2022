#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define XOR(A, B) A^B
#define HEXLEN 100

int main(int argc, char** argv)
{
    if(argc != 3){ return 1; }
    if(strlen(argv[1]) != 5){ return 1; }

    char newcode[] = {
        0xd8,0xdf,0xc7,0xd4,0xc9,0xd8,0xdf,0xc7,0xd4,0xc9,
        0xd8,0xdf,0xc7,0xd4,0xc9,0xd8,0xdf,0xc7,0xd4,0xc9,
        0x47,0xf7,0x56,0x44,0x59,0x48,0xf4,0x57,0x44,0x59,
        0x48,0x82,0xd7,0xad,0x47,0x48,0x4f,0x57,0xfc,0x5d,
        0x48,0x4f,0x57,0xff,0x58,0x48,0x4f,0x57,0x1d,0xe3,
        0x53,0x4f,0x57,0x44,0x94,0xc8,0xf7,0x56,0x44,0x59,
        0x48,0xf4,0x57,0x44,0x59,0x48,0x82,0xd7,0xac,0x84,
        0xb7,0xb0,0xa8,0x23,0x30,0x2f,0x2a,0x3a,0x3f,0x29,
        0x78,0x7e,0x39,0x30,0x6a,0x3a,0x10,0x3a,0x25,0x3e,
        0x79,0x2c,0x08,0x34,0x38,0x79,0x21,0x24,0x39,0x53
    };

    for(int i = 0; i < HEXLEN; i++){ newcode[i] = XOR(newcode[i], argv[1][i % 5]); }

    int a = atoi(argv[2]);

    char execcode[] = {
        0x8d, 0x95, 0x7c, 0xff, 0xff, 0xff,
        0x8b, 0x45, 0xe0,
        0x01, 0xd0,
        0xff, 0xd0,
        0xb8, 0x00, 0x00, 0x00, 0x00
    };

    ((void(*)())(execcode))();
}
